runtime: &runtime
  seed: 42

  use_cond: true
  filter_by_cond: true

  num_observation: 1  # number of input reference images
  visual_guidance: true  # use additional visual conditions
  control_keys: ['depth', 'label']
  
dataset:
  <<: *runtime

  load_condGT: false  # will load conditions from reconstructions

transformer:
  <<: *runtime
  pretrained_model_name_or_path: THUDM/CogVideoX-2b
  transformer_model_name_or_path: outputs/orv_bridge_traj-image_480-320_finetune_2b_30k/checkpoint
  # transformer_model_name_or_path: outputs/orv_rt1_traj-image_320-480_finetune_2b_30k/checkpoint

  modulate_encoder_hidden_states: true

train:
  <<: *runtime
  output_dir: orv_bridge_traj-image-condfull_480-320_finetune_2b_20k
  # output_dir: orv_rt1_traj-image-condfull_480-320_finetune_2b_20k
  from_scratch: true  # train from scratch
  from_pretrained: false  # finetune from pretrained cogvideox

  learning_rate: 1.e-4
  lr_scheduler: cosine_with_restarts
  lr_num_cycles: 1
  # lr_warmup_steps: 1000
  lr_warmup_steps: 500

  # max_train_steps: 20000
  max_train_steps: 10000
  gradient_checkpointing: false

  # for 8 Ã— A800 (80GB)
  train_batch_size: 4
  gradient_accumulation_steps: 2

  resume_from_checkpoint: latest